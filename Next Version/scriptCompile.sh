#!/bin/sh
#Usage: ./$0 <script.esp >scriptCode
sed -e 's;//.*$;;' -e 's;^if[ \t]; | ;' -e 's;[ \t+]if[ \t+]; | ;g' -e 's;[ \t+]then[ \t+]; ? ;g' -e 's;[ \t+]else[ \t+]; ^ ;g' -e 's/[ \t+]fi/ ; /g' -e 's;\([^ \t+(]*(\);\L\1;g' -e 's;[ \t];;g' -e 's;+; ;g' -e 's;&&; ;g' -e 's;sethostname(;H;' -e 's;setntp(;N;' -e 's;setgpio(;S;g' -e 's;clearvar(;$;g' -e 's;unsetvar(;$;g' -e 's;setvar(;$;g' -e 's;save(;B;' -e 's;incr(;I;g' -e 's;gpio(;~;g' -e 's;cleartimer(;T;g' -e 's;resettimer(;T;g' -e 's;timer(;T;g' -e 's;settimer(;T;g' -e 's;mqttsend(\([^)]*\));M{\1};g' -e 's;);;g' -e 's;INPUT_PULLUP;3;g' -e 's;INPUT;2;g' -e 's;OUTPUT_UP;1;g' -e 's;OUTPUT_DOWN;0;g' -e 's;";\\";g' -e 's;$;\\;' |awk '!/^\\$/'
